<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
    <title>WeApp Dashboard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
  </head>

  <body>
    <nav class="navbar navbar-expand-lg fixed-top" style="background-color: #e3f2fd;">
      <a class="navbar-brand" href="/">
        <img src="/images/logo_cropped.png" id="logo" class="d-inline-block align-top" alt="">
        WeApp
      </a>
      <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
        <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
          <li class="nav-item active">
            <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
          </li>
        </ul>
        <div>
          <form class="form-inline">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit" id="searchButton">Search</button>
          </form>
        </div>

        <div sec:authorize="!isAuthenticated()">
          <button type="button" class="btn btn-outline-info my-2 my-sm-0" id="loginBtn">Login</button>
        </div>
        <script type="text/javascript">
          $(function() {
            $("#loginBtn").click(function() {
              window.location.href = "/login";
            })
          });

        </script>

        <div sec:authorize="isAuthenticated()">
          <form action="/logout" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit" class="btn btn-outline-info my-2 my-sm-0">Logout</button>
          </form>
        </div>
      </div>
    </nav>
    <main role="main" class="container">
      <div class="starter-template">
        <h1>Application list view</h1>
        <table class="table mt-5" th:if="${applications != null}">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Name</th>
              <th scope="col">Version</th>
              <th scope="col">Organization</th>
              <th scope="col">Platform</th>
              <th scope="col">Price</th>
              <th scope="col">Link</th>
              <th scope="col">Description</th>
              <th scope="col">Edit</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="app : ${applications}">
              <th scope="row" th:text="${app.id}"></th>
              <td th:text="${app.name}"></td>
              <td th:text="${app.version}"></td>
              <td th:text="${app.organization}"></td>
              <td th:text="${app.platform}"></td>
              <td th:text="${app.price}"></td>
              <td th:text="${app.link}"></td>
              <td th:text="${app.description}"></td>
              <td>
                <a th:href="@{/applications/{applicationId}(applicationId=${app.id})}" class="btn btn-primary btn-rounded btn-sm my-0">Edit</a>
              </td>
            </tr>
          </tbody>
        </table>
        <form action="/applications" method="post">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          <button class="btn btn-primary" id="requestApplication">Add an Application</button>
        </form>
      </div>
    </main>
  </body>

</html>
